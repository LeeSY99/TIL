# K-최근접 이웃 회귀 (KNN Regression)

- KNN 분류와 비슷하게, 예측 샘플에 가장 가까운 샘플 **k개를 골라 평균**을 내어 예측.

---

## 결정계수 (R²)

- 회귀 문제 성능 측정 도구 중 하나.
- 값이 **1에 가까울수록 성능이 좋음**.
- 1 - (타깃 - 예측)^2의 합 / 타깃 - 타깃 평균

$$
1-(target-predict)^2/(target - avg)^2
$$

- 분모 : 실제 값이 평균에서 얼마나 퍼져있는지 → 평균정도를 예측할수록 분자와 분모가 비슷해짐 → 이것은 그냥 평균수준으로 예측한다는 것은 모델 존재 의미가 없어진다. (예시: 그냥 평균냈을 때 딱봐도 이정도 수준인데 그것보다 못맞춘다는 것은 모델로 예측하는 의미가 사라짐)
- 1보다 값을 가지며
    - 타깃과 예측값이 같아질수록 분자가 0에수렴 → 1에 가까워짐 → 성능 좋음
    - 단순히 타깃값의 평균으로 예측하는 수준 → 분모와 분자의 값이 같아짐 → 0에 가까워짐
    - 0보다 작은경우, 타깃 평균으로 예측을 내보낸것보다도 못맞춘 셈

---

과대적합 (Overfitting)

- 훈련 세트에 지나치게 학습하여, 새로운 데이터에서는 일반화 성능이 떨어지는 현상.

---

## KNN 회귀의 문제점

- 가까운 샘플의 평균을 내므로 **범위 밖 데이터 예측 불가능**
    - 범위 밖 데이터: 훈련 데이터의 최소/ 최대 범위 밖인 데이터
    - 예) 키로 몸무게 예측하는 모델에서 훈련엔 키가 [150~190]인 데이터로 훈련했지만 200이나 210인 입력이 들어온다면 가장 가까이 있는 k개 샘플(가장 큰 k개)이 똑같이 선정이 되며 평균 또한 같아져서 같은 예측을 내보내게 된다.
- *이상치(Outlier)**가 평균값을 크게 왜곡.
- 근처 데이터가 적을 경우, 소수 샘플이 결과를 크게 왜곡.

---

## KNN 분류의 문제점

- 차원이 커질수록 모든 점들이 비슷하게 멀어져 → **정확도 하락** (차원의 저주).
- 데이터가 불균형할 때, 소수 클래스는 무시되기 쉬움.
- 결정 경계가 불안정하여 경계 부근에서 **작은 변화에도 민감**.

---

## 선형회귀 (Linear Regression)

- 데이터를 직선(선형 함수)으로 학습.
- 직선은 특성을 잘 나타낼 수 있는 최적의 직선.

### 한계

- 현실 데이터는 **비선형인 경우가 많음**.
- 단순 직선 하나로는 표현력이 부족.
    - 함수적 제약(직선)때문에 데이터의 복잡한 패턴을 담아내지 못함.
    - 비선형인 경우에 직선 하나로 제약을 걸어둔다면 예측과 정답의 차이가 심해질 것
    - 예) 키- 몸무게 예측을 하는데 키가 많이작다고 몸무게가 음수가 될 수 없는 것처럼

---

## 다항회귀 (Polynomial Regression)

- 다항식을 사용한 선형회귀.
- 하나의 특성을 거듭제곱하여 항을 추가해 데이터에 더 잘 맞게 학습 가능.
- 비선형처럼 보이지만 여전히 **선형회귀의 한 형태**.

---

## 다중회귀 (Multiple Linear Regression)

- 여러 개의 독립변수(특성)를 사용하여 하나의 종속변수를 예측.

### 다항회귀 vs 다중회귀

- **다항회귀**: 독립변수 1개 → 거듭제곱 항 추가 (곡선 관계 모델링).
- **다중회귀**: 서로 다른 독립변수 여러 개를 사용.

---

## 독립변수와 종속변수

- **독립변수(Feature, Input)**: 원인·조건, 종속변수에 영향을 줌. (입력)
    - **종속변수(Target, Output)**: 예측하고자 하는 목표값.(출력)

---

## 특성공학 (Feature Engineering)

- 기존 특성을 사용해 **새로운 특성**을 만드는 작업.
- 스케일 조정, 기존 특성을 조합해 특성 생성, 중요한 특성 선택 등을 포함.

---

## 규제 (Regularization)

- **과대적합을 줄이는 방법** 중 하나.

### 종류

- **릿지(Ridge)**: 계수를 줄여 0에 가깝게 만듦.
    - 계수: 특성이 예측에 반영되는 영향력과 방향
    - 이 영향력을 줄여 훈련셋에 너무 맞게 학습되지 않게 조정
- **라쏘(Lasso)**: 일부 계수를 아예 0으로 만들어 변수 선택 자동화.
